# ============================================
# GAN CONFIGURATION (Updated with WGAN-GP + Numeric Encoder)
# ============================================

# ----------------------------
# General Training
# ----------------------------
EPOCHS: 50 #200
BATCH_SIZE: 32
DEVICE: "cuda"
SEED: 42

SAVE_FREQ: 5
CHECKPOINT_DIR: "experiments/gan/checkpoints"
LOG_DIR: "experiments/gan/logs"
SAMPLE_DIR: "experiments/gan/samples"

# ----------------------------
# Dataset / Paths
# ----------------------------
TRAIN_SPLIT: "data/splits/train_split.csv"
VAL_SPLIT: "data/splits/val_split.csv"
SPLITS_DIR: "data/splits"
PROCESSED_DIR: "data/processed"

# latent features coming from AE encoder
ENCODER_FEATS_TRAIN: "data/splits/train/encoder_feats.npy"
ENCODER_FEATS_VAL: "data/splits/val/encoder_feats.npy"

# --- NEW ---
# Precomputed numpy arrays for numeric features (must align with encoder feats)
# Assumes these files exist: <SPLITS_DIR>/<split_name>/numeric_features.npy
# (e.g., data/splits/train/numeric_features.npy)

# ----------------------------
# Model Architecture
# ----------------------------
INTEGRATION_MODE: "warm_start" # warm_start | conditioning

# Generator
NOISE_DIM: 128
LATENT_DIM: 64 # This is the AE's latent dim
MAX_NOTES: 512 # Should match your data preprocessing
NOTE_DIM: 4 # (pitch, velocity, duration, start_time)
GEN_HIDDEN: 512

# ----------------------------
# Optimizers
# ----------------------------
LR_G: 0.0002
LR_D: 0.0001
LR_E: 0.0001 # Learning rate for FeatureEncoder (if separate, else ignored)
WEIGHT_DECAY: 0.0
BETA1: 0.5 # Recommended for WGAN
BETA2: 0.9 # Recommended for WGAN

# ----------------------------
# WGAN-GP Settings (NEW)
# ----------------------------
USE_WGANGP: true
LAMBDA_GP: 10.0 # Gradient penalty weight
CRITIC_ITERS: 5 # Number of Critic (D) updates per 1 Generator (G) update

# ----------------------------
# Emotion Discriminator Training
# ----------------------------
LAMBDA_EMOTION: 5.0 # weight of emotion classification loss

# ----------------------------
# Numeric Feature Encoder (NEW)
# ----------------------------
USE_NUMERIC_ENCODER: true

# number of scalar features per sample (update based on your metadata)
# Example: tempo, key, scale, RMS, spectral_centroid, duration â†’ 6
NUMERIC_INPUT_DIM: 6

# Encoder architecture
ENCODER_HIDDEN: [256, 128]
ENCODER_OUT_DIM: 128
ENCODER_DROPOUT: 0.2
ENCODER_USE_SN: false # Spectral norm for encoder

# ----------------------------
# Sampling / Generation
# ----------------------------
N_SAMPLES_PER_EMOTION: 2
